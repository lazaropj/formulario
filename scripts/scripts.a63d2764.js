"use strict";angular.module("mytodoApp",["ngResource","ngSanitize","ui.router","ui.sortable","mytodoApp.config.interceptors","backand"]).config(["$stateProvider","$httpProvider","$urlRouterProvider","BackandProvider",function(a,b,c,d){d.setSignUpToken("16dafeac-dafb-40d8-a66c-fbd394794918"),d.setAnonymousToken("77a6e8dd-2ad3-465c-b04d-a0db93386b8c"),b.interceptors.push("todoHttpInterceptor"),c.otherwise("/"),a.state("todos",{url:"/",templateUrl:"views/main/main.html",controller:"MainCtrl as vm"}).state("login",{url:"/login",templateUrl:"views/login/login.html",controller:"LoginCtrl as vm"})}]),function(){function a(a,b){function c(){b.name="todo",d()}function d(){b.readAll().then(e,g)}function e(a){h.todos=a}function f(a){h.todos.push(a)}function g(a){console.log(a)}var h=this;h.updateTodo=function(a){b.update(a.id,a).then(null,g)},h.addTodo=function(){b.create({description:h.todo}).then(f,g),h.todo=""},h.removeTodo=function(a){b.delete(a.id).then(function(){h.todos.splice(h.todos.indexOf(a),1)},g)},h.logout=function(){b.logout(),a.go("login")},c()}a.$inject=["$state","TodoService"],angular.module("mytodoApp").controller("MainCtrl",a)}(),function(){function a(a,b){function c(){d.username="",d.password="",d.appName=""}var d=this;d.signIn=function(){a.setAppName(d.appName),a.signin(d.username,d.password).then(function(){b.path("/")},function(a){console.log(a),d.error=a&&a.error_description||"Unknown error from server"})},c()}a.$inject=["Backand","$location"],angular.module("mytodoApp").controller("LoginCtrl",a)}(),function(){function a(a,b){var c=this,d="/1/objects/";c.name=null,c.readAll=function(){return a({method:"GET",url:b.getApiUrl()+d+c.name}).then(function(a){return a.data.data})},c.readOne=function(e){return a({method:"GET",url:b.getApiUrl()+d+c.name+"/"+e}).then(function(a){return a.data})},c.create=function(e){return a({method:"POST",url:b.getApiUrl()+d+c.name,data:e,params:{returnObject:!0}}).then(function(a){return a.data})},c.update=function(e,f){return a({method:"PUT",url:b.getApiUrl()+d+c.name+"/"+e,data:f}).then(function(a){return a.data})},c.delete=function(e){return a({method:"DELETE",url:b.getApiUrl()+d+c.name+"/"+e})},c.logout=function(){b.signout()}}angular.module("mytodoApp").service("TodoService",["$http","Backand",a])}(),function(){function a(a,b,c){return{requestError:function(b){return a.reject(b)},response:function(a){return a},responseError:function(d){if((d.config.url+"").indexOf("token")===-1&&401===d.status&&!c.isManagingRefreshToken()){c.getUsername()?"The session has expired, please sign in again.":null;b.path("/login")}return a.reject(d)}}}angular.module("mytodoApp.config.interceptors",[]).factory("todoHttpInterceptor",["$q","$location","Backand",a])}();